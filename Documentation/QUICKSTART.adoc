= Union Policy Parser - Quickstart Guide
:toc: left
:license: PMPL-1.0-or-later

== What We Built

You now have a complete **union-policy-parser** architecture that combines:

* **A2ML** - Attested Markup Language for contract structure
* **K9-SVC** - Self-validating deployment with cryptographic signatures
* **Union schemas** - NUJ Code of Ethics as machine-readable policy

== Files Created

=== 1. Example Contract (A2ML)

**Location:** `examples/ou-day-employee-contract.a2ml`

The Open University Day Employees Contract (HRP052) converted to A2ML with:

* 17 sections fully encoded
* Legal references (UK Employment Rights Act 1996, ACAS, GDPR)
* Required/attestation fields for validation
* Must/should/could clauses

**Validation:**
[source,bash]
----
# Once implemented:
union-policy-parser validate examples/ou-day-employee-contract.a2ml \
  --schema schemas/uk-employment-law.a2ml \
  --mode checked
----

=== 2. NUJ Ethics Schema (A2ML)

**Location:** `schemas/nuj-code-of-ethics.a2ml`

Complete NUJ Code of Conduct encoded with:

* **15 principles** (8 must, 4 should, 3 could)
* Core ethics: Truth, independence, fairness, privacy, accountability
* Best practices: Transparency, diversity, accessibility
* Advocacy: Mental health, algorithmic transparency, portable benefits
* Enforcement: Grievance procedures, automated checks

**Key Clauses:**

[%header,cols="1,2,1"]
|===
| Clause | Description | Type

| Truth and Accuracy
| Factual accuracy, prompt corrections
| MUST

| Independence
| Editorial independence, no conflicts
| MUST

| Source Protection
| Protect confidential sources
| MUST

| Fairness
| Right of reply, balanced reporting
| MUST

| Privacy
| Respect privacy, avoid harassment
| MUST

| Transparency
| Disclose funding, conflicts
| SHOULD

| Diversity
| Reflect diverse voices
| SHOULD

| Portable Benefits
| Health insurance, pensions for freelancers
| COULD
|===

**Usage:**
[source,bash]
----
# Validate a journalist's contract against NUJ ethics
union-policy-parser validate journalist-contract.a2ml \
  --schema schemas/nuj-code-of-ethics.a2ml \
  --clause "source-protection" \
  --clause "editorial-independence"
----

=== 3. Architecture Document

**Location:** `Documentation/ARCHITECTURE.adoc`

Complete system design including:

* Three-layer architecture (A2ML + K9 + union-policy-parser)
* Workflows for freelancers, employers, union reps
* Security model (asymmetrical power, Ed25519 signatures)
* CLI interface design
* Integration with K9-SVC and Hypatia (CI/CD)
* Future roadmap (formal verification, WASM, AI)

== Quick Example: Validating a Contract

=== Scenario

A freelance journalist receives a contract. They want to check if it complies with NUJ ethics before signing.

=== Steps

**1. Convert contract to A2ML** (or ask employer to provide it):

[source,bash]
----
# Manual authoring:
vim my-contract.a2ml

# Or automated from PDF (future):
pdf-to-a2ml employer-contract.pdf > my-contract.a2ml
----

**2. Validate against NUJ schema:**

[source,bash]
----
union-policy-parser validate my-contract.a2ml \
  --schema schemas/nuj-code-of-ethics.a2ml \
  --mode attested
----

**3. Check output:**

[source]
----
✅ VALID: Contract complies with NUJ Code of Ethics

Required clauses present:
  ✓ Source protection (§6)
  ✓ Editorial independence (§2)
  ✓ Right of reply (§3)
  ✓ Copyright retention (§10)

Warnings:
  ⚠️  Missing recommended clause: Algorithmic transparency (§14)
  ⚠️  Missing recommended clause: Portable benefits (§15)

Suggestions:
  → Add: "Employer shall not use AI editorial tools without human review"
  → Add: "Employer contributes £X/month to freelancer health insurance"
----

**4. If invalid, auto-generate grievance:**

[source,bash]
----
union-policy-parser grievance my-contract.a2ml \
  --violation "missing-source-protection" \
  --template templates/nuj-grievance.md \
  --output grievance-2025-001.md
----

**Output:** Pre-filled grievance letter citing NUJ Code §6, ready to send to employer.

== Asymmetrical Power: How This Helps Unions

=== Union Advantages

[%header,cols="2,3"]
|===
| Feature | Benefit

| **Automated validation**
| Instant compliance checks; employers must audit manually

| **Grievance templates**
| Pre-filled legal letters in seconds; employers need lawyers

| **Batch processing**
| Validate 100+ contracts at once; scales to union size

| **K9 signatures**
| Tamper-proof contracts; employer cannot alter terms

| **PMPL license**
| Employers can use but not weaponize (copyleft blocks proprietary forks)

| **Formal proofs**
| Idris2 proves contract legality; legal backing in tribunals
|===

=== Employer Constraints

[%header,cols="2,3"]
|===
| Constraint | Impact

| **Must comply with schemas**
| Cannot hide unfair terms; all clauses validated

| **Signature verification**
| Cannot modify union-approved contracts without detection

| **Transparent audit trails**
| All validation checks logged (OpenSSF Scorecard)

| **Public accountability**
| Failures visible in CI/CD (GitHub Actions)

| **No proprietary extensions**
| PMPL license prevents employer-only features
|===

== Integration with K9-SVC

=== Why K9?

K9 adds **self-validation** and **deployment security** to A2ML contracts:

* **Leash model:** Three security levels (Kennel/Yard/Hunt)
* **Nickel contracts:** Type-safe validation rules
* **Just recipes:** Automated deployment workflows
* **Ed25519 signatures:** Cryptographic tamper-proofing

=== Example: K9-Wrapped Contract

**File:** `contracts/freelance-contract.k9.ncl`

[source,nickel]
----
{
  pedigree = {
    name = "freelance-journalist-contract",
    version = "1.0.0",
  },

  validation = {
    schema = "schemas/nuj-code-of-ethics.a2ml",
    required_clauses = [
      "source-protection",
      "editorial-independence",
      "copyright-retention",
    ],
  },

  recipes = {
    validate = "union-policy-parser validate ${self.payload}",
    sign = "k9-sign --key ~/.ssh/nuj-rep.ed25519",
    deploy = "cp ${self.payload} /contracts/validated/",
  },

  payload = "./freelance-contract.a2ml",
}
----

**Usage:**

[source,bash]
----
# Validate via K9 recipe
just -f contracts/freelance-contract.k9.ncl validate

# Sign with union rep's key
just -f contracts/freelance-contract.k9.ncl sign

# Verify signature
k9-verify contracts/freelance-contract.k9.ncl
# Output: ✅ Signature valid (NUJ Rep)
----

== Next Steps

=== Immediate (Week 1)

1. **Implement Rust CLI:**
   - A2ML parser integration
   - Schema validation logic
   - Basic grievance generation

2. **Test with real contracts:**
   - Validate `examples/ou-day-employee-contract.a2ml`
   - Check against `schemas/nuj-code-of-ethics.a2ml`

3. **Add more schemas:**
   - `schemas/iww-freelancer-rights.a2ml`
   - `schemas/ucu-academic-standards.a2ml`
   - `schemas/uk-employment-law.a2ml`

=== Short-term (Month 1)

4. **K9 integration:**
   - Package contracts as `.k9` files
   - Add Ed25519 signing workflow
   - Test signature verification

5. **Julia batch processor:**
   - Validate 10+ contracts at once
   - Generate compliance reports (JSON/HTML)

6. **CI/CD with Hypatia:**
   - GitHub Actions workflow
   - Auto-file grievances on validation failure

=== Medium-term (Quarter 1)

7. **Idris2 formal verification:**
   - Prove contract properties (e.g., "termination complies with ERA 1996")
   - Decidable validation predicates

8. **WASM runtime:**
   - Browser-based validation
   - Freelancer self-service portal

9. **PDF-to-A2ML converter:**
   - Automate contract conversion
   - Use llm-verify for quality checks

== FAQ

**Q: Why A2ML instead of JSON/YAML?**

A: A2ML provides:

* **Attestation:** Verify claims against external sources (UK law, NUJ standards)
* **Typed core:** Idris2 proofs for legal guarantees
* **Opaque payloads:** Byte-for-byte preservation (critical for legal docs)
* **Human-readable:** Easier for union members to author/review

**Q: Why K9 on top of A2ML?**

A: K9 adds:

* **Self-validation:** Contracts carry their own validation rules
* **Security levels:** Graduated trust (Kennel/Yard/Hunt)
* **Signatures:** Tamper-proof with Ed25519
* **Deployment:** Just recipes for automated workflows

**Q: Can employers use this against unions?**

A: No, due to **asymmetrical design**:

* PMPL license prevents proprietary forks (copyleft)
* Unions get automation; employers face manual audits
* K9 signatures prevent contract tampering
* Formal proofs provide legal backing for unions

**Q: What about non-NUJ unions (IWW, UCU)?**

A: Easy to extend:

* Create `schemas/iww-freelancer-rights.a2ml`
* Create `schemas/ucu-academic-standards.a2ml`
* Same validation engine, different schemas

**Q: How do I contribute?**

A: See `CONTRIBUTING.adoc`:

* License: PMPL-1.0-or-later
* Languages: Rust (CLI), Julia (batch), Idris2 (proofs)
* Submit A2ML schemas for new unions
* Improve validation logic
* Add grievance templates

== Resources

**Documentation:**

* `ARCHITECTURE.adoc` - Full system design
* `examples/ou-day-employee-contract.a2ml` - Real contract example
* `schemas/nuj-code-of-ethics.a2ml` - NUJ policy schema

**External References:**

* A2ML repo: `~/Documents/hyperpolymath-repos/a2ml/`
* K9-SVC repo: `~/Documents/hyperpolymath-repos/k9-svc/`
* NUJ Code of Conduct: https://www.nuj.org.uk/about/nuj-code/
* ACAS Code of Practice 1: https://www.acas.org.uk

**Community:**

* GitHub: https://github.com/hyperpolymath/union-policy-parser
* License: PMPL-1.0-or-later (Palimpsest MPL)
* Contact: Jonathan D.A. Jewell <jonathan.jewell@open.ac.uk>

== License

This document and all union-policy-parser code is licensed under:

**PMPL-1.0-or-later** (Palimpsest Mozilla Public License)

See: `LICENSE` file in repository root.
